@model ResourceManagement.Models.RMA_EmployeeModel

@{
    ViewBag.Title = "TimeSheet Page";
}

<style>
    body {
        background-color: #DDE4E3;
        font-size: 13px;
    }

    .sample-label {
        font-weight: 100;
    }
</style>

<nav class="navbar navbar-expand-lg nav-bar-bg navbar-inverse navbar-fixed-top">
    <a class="navbar-brand" href="#"><img src="~/Assets/AMBC_Logo.png" alt="Header Logo" /></a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarText" aria-controls="navbarText" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>
    <div class="time-headertitle" style="">
        <h2 class="text-uppercase text-white">Employee Time Sheet</h2>

    </div>

    <div class="col-lg-offset-3">
        @if (Model != null)
        {
            <div class="agent-navigation">
                <div class="">
                    <div class="dropdownheading text-white">
                        <div class="profile-img">
                            <img src="~/Assets/Rajender_Passport_Photo.jpg" class="img-fluid rounded-circle" width="40" alt="Cinque Terre">
                        </div>
                        <p>@Model.empInfo.employee_name</p>
                    </div>

                    <div class="agent-description hide" style="">
                        <div class="agent-details">
                            <div class="agent-img">
                                <img alt="Bantle_Martin Bantle_625x313" src="~/Assets/Rajender_Passport_Photo.jpg" data-imagehash="datazwpimghash" loading="lazy">

                            </div>

                            <div class="agent-fullname">
                                <b>@Model.empInfo.employee_name</b>
                            </div>


                            <ul>
                                <li>
                                    <b>Emp ID:</b>
                                    <div class="agent-navdrop-empid">@Model.empInfo.employee_id</div>

                                </li>

                                <li>
                                    <b>Designation:</b>
                                    <div class="agent-navdrop-empdesig">@Model.empInfo.employee_desg</div>

                                </li>

                                <li>
                                    <b>Supervisor:</b>
                                    <div class="agent-navdrop-empmanager">@Model.empInfo.employee_report_manager</div>

                                </li>

                                <li>
                                    <b>Contact Number:</b>
                                    <br />
                                    <a class="agent-navdrop-phone" href="tel:07531 282590">@Model.empInfo.employee_mobile</a>
                                </li>

                                <li>
                                    <b>Client:</b>
                                    <div class="agent-navdrop-client">@Model.projectInfo.proj_client</div>
                                </li>

                                <li>
                                    <b>Project:</b>
                                    <div class="agent-navdrop-project">@Model.projectInfo.proj_name</div>
                                </li>
                                <li>
                                    <b>Project Status:</b>
                                    <div class="agent-navdrop-prostatus">@Model.projectInfo.project_staus</div>
                                </li>

                                <li>
                                    <b>E-Mail Address:</b>
                                    <div class="agent-navdrop-empemail">@Model.empInfo.employee_mailid</div>
                                </li>

                            </ul>

                        </div>

                    </div>
                </div>
            </div>
        }

    </div>
</nav>

@*<div class="row">
        <div class="col-md-6">
            <div class="form-group">
                <label for="timeSheetdate">Select Week</label>
                <input type="date" class="form-control" id="timeSheetSelectWeek" placeholder="Select week start date">
            </div>
            <div class="form-group">
                <label for="timeSheetdate">End Date</label>
                <input type="date" class="form-control" id="timeSheetSelectWeek" placeholder="Select week start date">
            </div>

            <button type="button" class="btn btn-success">Submit</button>

        </div>
    </div>*@

<div class="row">
    <div class="col-md-6">
        <button type="button" class="btn btn-custom openmodel btn-lg text-white" data-toggle="modal" data-target="#exampleModalLong">
            Click here to add task details
        </button> &nbsp;&nbsp;
    </div>
</div>


<div class="table-responsive table">
    <!--Table-->
    <table class="table table-striped timesheet-table-grid">

        <!--Table head-->
        <thead class="table-bordered">
            <tr>
                <th class="time-header" scope="col">Date</th>&nbsp;&nbsp;
                <th class="time-header" scope="col">Category</th>
                <th class="time-header" scope="col">Incident Number</th>
                <th class="time-header" scope="col">Incident Desc</th>
                <th class="time-header" scope="col">Requester</th>
                <th class="time-header" scope="col">Urgency</th>
                <th class="time-header" scope="col">Status</th>
                <th class="time-header" scope="col">Date Closed</th>
                <th class="time-header" scope="col">Time Spent</th>
                <th class="time-header" scope="col">Comments</th>
            </tr>
        </thead>
        <!--Table head-->
        <!--Table body-->
        <tbody class="table-bordered">
            <tr class="default-table-row ">
                <td scope="row" style="white-space: nowrap">Ex: @System.DateTime.Now.ToString("dd/MM/yyyy")</td>
                <td scope="row" style="white-space: nowrap">Ex: Enter Category</td>
                <td scope="row">Ex: 1234, 5678</td>
                <td scope="row">Ex: Enter details</td>
                <td scope="row" style="white-space: nowrap">Ex: Requester Name</td>
                <td scope="row" style="white-space: nowrap">Ex: Critical </td>
                <td scope="row" style="white-space: nowrap">Ex: In Progress</td>
                <td scope="row" style="white-space: nowrap">Ex: @System.DateTime.Now.ToString("dd/MM/yyyy")</td>
                <td scope="row" style="white-space: nowrap">Ex: 5</td>
                <td scope="row">Ex:Enter Comments</td>
            </tr>
        </tbody>
        <!--Table body-->
    </table>
    <!--Table-->
</div>

<!-- Button trigger modal -->

<div class="col-lg-offset-0" style="float:right">
    <button type="button" class="btn btn-info btn-lg timesheet-submit">
        Submit Time Sheet
    </button>
</div>

<!-- Modal -->
<div class="modal fade" id="exampleModalLong" tabindex="-1" role="dialog" aria-labelledby="exampleModalLongTitle" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header popup-design-header text-white">
                <h5 class="modal-title" id="exampleModalLongTitle">Time Sheet Form</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <form>
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-group">
                                <label for="timeSheetdate">Date</label>
                                <input type="date" class="form-control" id="timeSheetdate" placeholder="Enter Date">
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label for="timeSheetCategory">Category</label>

                                <select id="timeSheetCategory" name="categories" class="form-control form-select form-select-lg mb-3">
                                    <option value="volvo">Category 1</option>
                                    <option value="saab">Category  2</option>
                                </select>

                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-12">
                            <div class="form-group">
                                <label for="timeSheetIncNumber">Incident Number</label>
                                <textarea class="form-control" id="timeSheetIncNumber" style="min-width: 100%" placeholder="Incident Number"></textarea>
                            </div>
                        </div>

                    </div>

                    <div class="row">
                        <div class="col-md-12">
                            <div class="form-group">
                                <label for="timeSheetIncDesc">Incident Description</label>
                                <textarea class="form-control" id="timeSheetIncDesc" style="min-width: 100%" placeholder="Incident Description"></textarea>
                            </div>
                        </div>
                    </div>



                    <div class="row">
                        <div class="col-md-4">
                            <div class="form-group">
                                <label for="timeSheetRequester">Requester</label>
                                <input type="text" class="form-control" id="timeSheetRequester" placeholder="Requester">
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label for="timeSheetUrgency">Priority</label>

                                <select id="timeSheetUrgency" name="urgency" class="form-control form-select form-select-lg mb-3">
                                    <option value="critical"> Critical </option>
                                    <option value="high"> High </option>
                                    <option value="medium"> Medium </option>
                                    <option value="low"> Low </option>
                                </select>

                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label for="timeSheetStatus">Status</label>

                                <select id="timeSheetStatus" name="status" class="form-control form-select form-select-lg mb-3">
                                    <option value="open"> Open </option>
                                    <option value="closed"> Closed </option>
                                    <option value="inprogress"> In Progress </option>
                                    <option value="ongoing"> On Going </option>
                                </select>
                            </div>
                        </div>
                    </div>


                    <div class="row">

                        <div class="col-md-4">
                            <div class="form-group">
                                <label for="timeSheetClosedDate">Closed Date</label>
                                <input type="date" class="form-control" id="timeSheetClosedDate" placeholder="Closed Date">
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label for="timeSheetTimeSpent">Time Spent</label>
                                <input type="text" class="form-control" id="timeSheetTimeSpent" placeholder="Time Spent">
                            </div>
                        </div>
                    </div>


                    <div class="row">
                        <div class="col-md-12">
                            <div class="form-group">
                                <label for="timeSheetComments">Comments</label>
                                <textarea class="form-control" id="timeSheetComments" style="min-width: 100%" placeholder="Comments"></textarea>
                            </div>
                        </div>
                    </div>

                </form>
            </div>
            <div class="modal-footer">
                <input type="button" class="btn btn-secondary btn-lg" data-dismiss="modal" value="Close">
                <input type="button" class="btn btn-primary timesheet-addreport btn-lg" value="Add Report">
            </div>
        </div>
    </div>
</div>


<script>



    jQuery(document).ready(function () {
        timeSheetList = new Array();

        jQuery(".timesheet-addreport").click(function () {

            var model = {
                Date: jQuery('#timeSheetdate').val(),
                Category: $('#timeSheetCategory :selected').text(),
                IncidentNumber: jQuery('#timeSheetIncNumber').val(),
                IncidentDescription: jQuery('#timeSheetIncDesc').val(),
                Requester: jQuery('#timeSheetRequester').val(),
                Urgency: $('#timeSheetUrgency :selected').text(),
                Status: $('#timeSheetStatus :selected').text(),
                ClosedDate: jQuery('#timeSheetClosedDate').val(),
                TimeSpent: jQuery('#timeSheetTimeSpent').val(),
                Comments: jQuery('#timeSheetComments').val(),
            };

            timeSheetList.push(model);


            var template = '<tr><td class="timesheet-date"></td>'
                + '<td class="timesheet-category" ></td >'
                + '<td class="timesheet-incidentnum" ></td >'
                + '<td class="timesheet-incidentdes" ></td >'
                + '<td class="timesheet-requester" ></td >'
                + '<td class="timesheet-urgency" ></td >'
                + '<td class="timesheet-status" ></td >'
                + '<td class="timesheet-closeddate" ></td >'
                + '<td class="timesheet-timespent" ></td >'
                + '<td class="timesheet-comments" ></td >'
                + '</tr>'

            var newRow = jQuery(template);
            jQuery(newRow).find('.timesheet-date').html(model.Date);
            jQuery(newRow).find('.timesheet-category').html(model.Category);
            jQuery(newRow).find('.timesheet-incidentnum').html(model.IncidentNumber);
            jQuery(newRow).find('.timesheet-incidentdes').html(model.IncidentDescription);
            jQuery(newRow).find('.timesheet-requester').html(model.Requester);
            jQuery(newRow).find('.timesheet-urgency').html(model.Urgency);
            jQuery(newRow).find('.timesheet-status').html(model.Status);
            jQuery(newRow).find('.timesheet-closeddate').html(model.ClosedDate);
            jQuery(newRow).find('.timesheet-timespent').html(model.TimeSpent);
            jQuery(newRow).find('.timesheet-comments').html(model.Comments);


            jQuery('.default-table-row').hide();
            jQuery(".timesheet-table-grid").append(jQuery(newRow))
            jQuery('.modal').modal('hide');

            jQuery('#timeSheetdate').val('');
            $("#timeSheetCategory option:first").attr('selected', 'selected');
            jQuery('#timeSheetIncNumber').val('');
            jQuery('#timeSheetIncDesc').val('');
            jQuery('#timeSheetRequester').val('');
            $("#timeSheetUrgency option:first").attr('selected', 'selected');
            $("#timeSheetStatus option:first").attr('selected', 'selected');
            jQuery('#timeSheetClosedDate').val('');
            jQuery('#timeSheetTimeSpent').val('');
            jQuery('#timeSheetComments').val('');

        });


        jQuery(".timesheet-submit").click(function () {

            jQuery.ajax({
                type: "POST",
                url: "/AddTimeSheet",
                data: JSON.stringify({ timesheetmodel: timeSheetList }),
                contentType: 'application/json; charset=utf-8',
                success: function () {

                }
            });
        });

    });
</script>

